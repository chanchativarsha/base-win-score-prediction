from flask import Flask, request, render_template
import numpy as np
import joblib

app = Flask(__name__)
model = joblib.load('Wins-Score.pkl')

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/predict', methods=['POST'])
def predict():
    try:
        # Use get() to safely retrieve values; convert to float
        features = [
            float(request.form.get('2B', 0)),
            float(request.form.get('3B', 0)),
            float(request.form.get('BB', 0)),
            float(request.form.get('SO', 0)),
            float(request.form.get('SB', 0)),
            float(request.form.get('CG', 0)),
            float(request.form.get('SHO', 0)),
            float(request.form.get('E', 0))
        ]
        prediction = model.predict([features])
        return render_template('index.html', prediction_text=f'Predicted Wins: {int(prediction[0])}')
    except Exception as e:
        return f"Error during prediction: {e}", 400
